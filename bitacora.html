<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>BitÃ¡cora - GeoChile Monitor</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f4f4f4; }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }
        h2 { border-bottom: 2px solid #D32F2F; color: #333; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; font-size: 0.9rem; }
        th { background: #333; color: white; padding: 10px; }
        td { border: 1px solid #ddd; padding: 8px; text-align: center; }
        .btn-volver { display: inline-block; padding: 10px 20px; background: #555; color: white; text-decoration: none; border-radius: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="btn-volver">â¬… Volver al Mapa</a>
        <h1>ðŸ“‹ BitÃ¡cora de Datos</h1>

        <h2>ðŸŒŠ Datos FÃ­sicos (Ãšltimos 20)</h2>
        <table>
            <thead><tr><th>Fecha</th><th>Temp (Â°C)</th><th>Salinidad</th><th>Vel. (m/s)</th><th>Nivel Mar</th></tr></thead>
            <tbody id="tabla-fisicos"><tr><td colspan="5">Cargando...</td></tr></tbody>
        </table>

        <h2>ðŸŒ¿ Datos BiolÃ³gicos (Ãšltimos 20)</h2>
        <table>
            <thead><tr><th>Fecha</th><th>Clorofila</th><th>OxÃ­geno</th></tr></thead>
            <tbody id="tabla-bio"><tr><td colspan="3">Cargando...</td></tr></tbody>
        </table>
    </div>

    <script>
        const API_URL = ''; 
        
        fetch(`${API_URL}/api/v1/bitacora-completa`)
            .then(res => res.json())
            .then(data => {
                // Llenar FÃ­sicos
                const tFis = document.getElementById('tabla-datos_fisicos');
                tFis.innerHTML = '';
                data.fisicos.forEach(d => {
                    // Calculamos magnitud velocidad
                    let vel = Math.sqrt((d.u||0)**2 + (d.v||0)**2).toFixed(2);
                    tFis.innerHTML += `<tr><td>${d.fecha}</td><td>${d.temp}</td><td>${d.salinidad}</td><td>${vel}</td><td>${d.nivel_mar}</td></tr>`;
                });

                // Llenar Bio
                const tBio = document.getElementById('tabla-datos_bio');
                tBio.innerHTML = '';
                data.biologicos.forEach(d => {
                    tBio.innerHTML += `<tr><td>${d.fecha}</td><td>${d.clorofila}</td><td>${d.oxigeno}</td></tr>`;
                });
            })
            .catch(err => alert("Error cargando bitÃ¡cora: " + err));
    </script>
</body>
</html>